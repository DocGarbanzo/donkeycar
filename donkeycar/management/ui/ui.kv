#:include common.kv
#:include tub_screen.kv
#:include train_screen.kv
#:include pilot_screen.kv
#:include car_screen.kv

<BlackButton@Button>
    color: 0, 0, 0, 1
    disabled_color: 0.2, 0.2, 0.2, 1

<TabBar>:
    size_hint_y: None
    height: common_height + 20
    padding: [10, 10]
    spacing: 10
    canvas.before:
        Color:
            rgba: 0.4, 0.2, 0.0, 1
        Rectangle:
            pos: self.pos
            size: self.size
    BlackButton:
        id: tub_btn
        text: 'Tub Manager'
        on_release:
            root.manager.current_screen.keys_enabled = False
            root.manager.current = 'tub'
            root.manager.current_screen.keys_enabled = True
            root.manager.current_screen.ids.tab_bar.disable_only(root.manager.current_screen.name)
    BlackButton:
        id: train_btn
        text: 'Trainer'
        on_release:
            root.manager.current_screen.keys_enabled = False
            root.manager.current = 'train'
            root.manager.current_screen.keys_enabled = True
            root.manager.current_screen.ids.tab_bar.disable_only(root.manager.current_screen.name)
    BlackButton:
        id: pilot_btn
        text: 'Pilot Arena'
        on_release:
            root.manager.current_screen.keys_enabled = False
            root.manager.current = 'pilot'
            root.manager.current_screen.keys_enabled = True
            if not root.manager.current_screen.index: root.manager.current_screen.index = 0
            root.manager.current_screen.ids.tab_bar.disable_only(root.manager.current_screen.name)
    BlackButton:
        id: car_btn
        text: 'Car Connector'
        on_release:
            root.manager.current_screen.keys_enabled = False
            root.manager.current = 'car'
            root.manager.current_screen.keys_enabled = True
            root.manager.current_screen.ids.tab_bar.disable_only(root.manager.current_screen.name)
            root.manager.current_screen.update_pilots()


<StartScreen>:
    BoxLayout:
        orientation: 'vertical'
        TabBar:
            id: tab_bar
            manager: root.manager
        Image:
            source: root.img_path
            size: self.texture_size
        StatusLabel:
            id: status
            text: 'Donkey getting ready...'


<DonkeyScreenManager>:
    StartScreen:
        id: start_screen
        name: 'start'
    TubScreen:
        id: tub_screen
    TrainScreen:
        id: train_screen
    PilotScreen:
        id: pilot_screen
    CarScreen:
        id: car_screen