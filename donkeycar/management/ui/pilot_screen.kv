
<PilotLoader>:
    spacing: 10
    title: 'Choose the pilot'
    orientation: 'horizontal'
    model_type: pilot_spinner.text
    RoundedButton:
        id: pilot_button
        text: 'Choose pilot'
        size_hint_x: 0.5
        disabled: True
        on_release:
            root.open_popup()
    MySpinner:
        id: pilot_spinner
        size_hint_x: 0.5
        text: 'Model type'
        values: drive_models
    MyLabel:
        id: pilot_file
        text: root.file_path


<TransformationPopup>:
    size_hint: 0.5, 1.0
    auto_dismiss: False
    pos_hint: {'center_x': .25 if self.right else 0.75, 'center_y': .5}

    BoxLayout:
        orientation: "horizontal"
        BoxLayout:
            orientation: 'vertical'
            id: selected_list
            spacing: 20

        BoxLayout:
            orientation: 'vertical'
            spacing: 20
            BoxLayout:
                spacing: 10
                orientation: 'vertical'
                id: trafo_list
            RoundedButton:
                text: "Close"
                size_hint_y: 0.1
                on_release: root.dismiss()


<PilotScreen>:
    name: 'pilot'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        BackgroundBoxLayout:
            size_hint_y: None
            height: self.minimum_height + layout_height
            Header:
                title: 'Multi Pilot Loader'
                description:
                    'Load pilots from the Trainer screen and compare the model '\
                    'inference with the recorded user data.'
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 1.5
            spacing: 10
            BackgroundBoxLayout:
                orientation: 'vertical'
                PilotLoader:
                    size_hint_y: None
                    height: self.minimum_height + layout_height
                    id: pilot_loader_1
                    num: '1'
                    data_panel: data_panel_1
                OverlayImage:
                    id: img_1
                    pilot: pilot_loader_1.pilot
                    throttle_field: data_in.throttle_field
                    is_left: True
                DataPanel:
                    size_hint_y: None
                    height: self.minimum_height + 60
                    id: data_panel_1
                    font_color: [0.2, 0.2, 1, 1]
                    screen: root
                    record: img_1.pilot_record
                    dual_mode: True
                    link: True
                    auto_text: root.map_pilot_field(data_in.auto_text)
            BackgroundBoxLayout:
                orientation: 'vertical'
                PilotLoader:
                    size_hint_y: None
                    height: self.minimum_height + layout_height
                    id: pilot_loader_2
                    num: '2'
                    data_panel: data_panel_2
                OverlayImage:
                    id: img_2
                    pilot: pilot_loader_2.pilot
                    throttle_field: data_in.throttle_field
                    is_left: False
                DataPanel:
                    size_hint_y: None
                    height: self.minimum_height + 60
                    id: data_panel_2
                    font_color: [0.2, 0.2, 1, 1]
                    screen: root
                    record: img_1.pilot_record
                    dual_mode: True
                    link: True
                    auto_text: root.map_pilot_field(data_in.auto_text)

        BackgroundBoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height + common_height
            Header:
                title: 'Augmentations and Transformations'
                description:
                    'Set image augmentation and transformations on '\
                    'the fly. Transformations execute before augmentations'\
                    'and post transformations afterwards.'

            BoxLayout:
                size_hint_y: None
                height: common_height
                orientation: 'horizontal'
                RoundedToggleButton:
                    id: button_bright
                    size_hint_x: 0.5
                    text: 'Brightness {:4.2f}'.format(slider_bright.value)
                    on_release: root.set_brightness(slider_bright.value)
                Slider:
                    id: slider_bright
                    value: 0
                    min: -0.5
                    max: 0.5
                    on_value: root.set_brightness(self.value)
                RoundedToggleButton:
                    id: button_blur
                    size_hint_x: 0.5
                    text: 'Blur {:4.2f}'.format(slider_blur.value)
                    on_release: root.set_blur(slider_blur.value)
                Slider:
                    id: slider_blur
                    value: 0
                    min: 0.001
                    max: 3
                    on_value: root.set_blur(self.value)
            BoxLayout:
                size_hint_y: None
                height: common_height
                orientation: 'horizontal'
                spacing: 10
                Transformations:
                    id: pre_transformation
                    title: 'Pre-Augmentation Transformations'
                    text: 'Set pre transformation'
                    pilot_screen: root
                    is_post: False
                    on_release: self.open_popup()
                Transformations:
                    id: post_transformation
                    title: 'Post-Augmentation Transformations'
                    text: 'Set post transformation'
                    pilot_screen: root
                    is_post: True
                    on_release: self.open_popup()

        BackgroundBoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height + 90
            Slider:
                size_hint_y: None
                height: common_height
                id: slider
                min: 0
                value: 0
                on_value: root.index = int(self.value)
            BoxLayout:
                orientation: 'horizontal'
                spacing: 10
                ControlPanel:
                    id: pilot_control
                    screen: root
                DataPanel:
                    id: data_in
                    font_color: [0.3, 0.8, 0.3, 1]
                    screen: root
                    record: root.current_record
                    dual_mode: True

